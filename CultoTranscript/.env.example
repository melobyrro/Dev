# Database Configuration
POSTGRES_HOST=db
POSTGRES_DB=culto
POSTGRES_USER=culto_admin
POSTGRES_PASSWORD=changeme

# Redis Configuration
REDIS_URL=redis://redis:6379/0

# Web Service Configuration
WEB_PORT=8000
INSTANCE_PASSWORD=admin123
SECRET_KEY=change-this-secret-key-in-production-use-openssl-rand-hex-32

# Whisper Configuration
# Options: tiny, base, small, medium, large-v3
# Recommendation: medium for UHD 770 (good balance of speed/accuracy)
WHISPER_MODEL_SIZE=medium

# Video Duration Filtering (fallback defaults if not in database)
# These values are used only if database settings are not configured
MIN_VIDEO_DURATION=300    # 5 minutes minimum
MAX_VIDEO_DURATION=9000   # 150 minutes maximum

# Optional: YouTube Data API (for channel discovery - not required for yt-dlp method)
# YOUTUBE_API_KEY=your_api_key_here

# Google Gemini AI Configuration (REQUIRED for V2 analytics)
# Get your API key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your_gemini_api_key_here
GEMINI_MODEL=gemini-2.5-flash
GEMINI_TEMPERATURE=0.7

# Advanced Analytics Configuration
# Maximum tokens per minute (Gemini Flash tier limit)
GEMINI_MAX_TOKENS_PER_MIN=1000000
# Maximum requests per minute (Gemini Flash tier limit)
GEMINI_MAX_REQUESTS_PER_MIN=60

# Smart Caching Configuration (Phase 1: Token Reduction)
# Enable analytics result caching (skips re-analysis if transcript unchanged)
ENABLE_ANALYTICS_CACHE=true

# Enable chatbot response caching (caches Q&A responses with 48h TTL)
ENABLE_CHATBOT_CACHE=true

# Chatbot cache time-to-live in hours (default: 48 hours)
CHATBOT_CACHE_TTL_HOURS=48

# Enable embedding deduplication (skips embedding regeneration if transcript unchanged)
ENABLE_EMBEDDING_DEDUP=true

# Enable lazy analytics loading (defer analytics until first video view)
ENABLE_LAZY_ANALYTICS=false

# Chatbot Semantic Deduplication (Phase 1: Result Deduplication)
# Enable deduplication of chatbot search results
CHATBOT_DEDUP_ENABLED=true

# Similarity threshold for removing duplicate segments (0.95 = 95% similar)
CHATBOT_DEDUP_THRESHOLD=0.95

# Maximum gap in seconds to merge adjacent segments
CHATBOT_MERGE_ADJACENT_SEC=30

# Maximum number of segments to return per video
CHATBOT_MAX_PER_VIDEO=2

# Embedding Segmentation Configuration (Phase 1: Overlap Removal)
# Mode for text segmentation: "none" (no overlap), "minimal" (10-word overlap), "legacy" (50-word overlap)
# "none" eliminates redundancy in chatbot responses but requires embedding regeneration
EMBEDDING_OVERLAP_MODE=none

# Target segment size in words (used when EMBEDDING_OVERLAP_MODE=none)
EMBEDDING_TARGET_WORDS=250

# Minimum segment size in words (used when EMBEDDING_OVERLAP_MODE=none)
EMBEDDING_MIN_WORDS=150

# Maximum segment size in words (used when EMBEDDING_OVERLAP_MODE=none)
EMBEDDING_MAX_WORDS=350

# LLM Backend Configuration (Phase 2: Local LLM Fallback)
# Primary LLM backend (gemini or ollama)
PRIMARY_LLM=gemini

# Fallback backend when primary fails (gemini or ollama)
FALLBACK_LLM=ollama

# Ollama API endpoint (Docker service name)
OLLAMA_URL=http://ollama:11434

# Ollama model to use (phi3:mini recommended for Intel UHD 770)
OLLAMA_MODEL=phi3:mini

# Caddy Reverse Proxy Configuration (for HTTPS deployment)
# Required if using Caddy with Cloudflare DNS challenge
# Get your token from: https://dash.cloudflare.com/profile/api-tokens
# Token needs: Zone.DNS (Edit) permission for your domain
# CLOUDFLARE_API_TOKEN=your_cloudflare_api_token_here

# YouTube WebSub (PubSubHubbub) Configuration
# Callback URL that YouTube will send notifications to
# Must be publicly accessible via HTTPS
WEBSUB_CALLBACK_URL=https://church.byrroserver.com/api/websub/callback
